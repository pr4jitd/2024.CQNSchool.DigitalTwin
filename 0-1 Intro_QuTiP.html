<!DOCTYPE html>
<html data-content_root="" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="Docutils 0.18.1: http://docutils.sourceforge.net/" name="generator"/>
<title>Lecture 0 - Introduction to QuTiP — CQN Winter School 2024 - Exploring and Designing Quantum Networks via Digital Twin Simulations</title>
<script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
<!-- Loaded before other Sphinx assets -->
<link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet"/>
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet"/>
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet"/>
<link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" rel="preload" type="font/woff2"/>
<link href="_static/pygments.css" rel="stylesheet" type="text/css"/>
<link href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" rel="stylesheet" type="text/css"/>
<link href="_static/togglebutton.css" rel="stylesheet" type="text/css"/>
<link href="_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" rel="stylesheet" type="text/css"/>
<link href="_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" rel="stylesheet" type="text/css"/>
<!-- Pre-loaded scripts that we'll load fully later -->
<link as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" rel="preload"/>
<link as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" rel="preload"/>
<script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>
<script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
<script src="_static/jquery.js"></script>
<script src="_static/underscore.js"></script>
<script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
<script src="_static/doctools.js"></script>
<script src="_static/clipboard.min.js"></script>
<script src="_static/copybutton.js"></script>
<script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
<script>let toggleHintShow = 'Click to show';</script>
<script>let toggleHintHide = 'Click to hide';</script>
<script>let toggleOpenOnPrint = 'true';</script>
<script src="_static/togglebutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
<script src="_static/design-tabs.js"></script>
<script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
<script async="async" src="_static/sphinx-thebe.js"></script>
<script>DOCUMENTATION_OPTIONS.pagename = '0-1 Intro_QuTiP';</script>
<link href="genindex.html" rel="index" title="Index"/>
<link href="search.html" rel="search" title="Search"/>
<link href="2-1%20Midpoint_Source_Tutorial.html" rel="prev" title="Midpoint Source Protocol for Quantum Links"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
<link href="_static/styles/chattutor.style.css" rel="stylesheet" type="text/css"/></head>
<body data-bs-root-margin="0px 0px -60%" data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-default-mode="" data-offset="180">
<a class="skip-link" href="#main-content" id="pst-skip-link">Skip to main content</a>
<div id="pst-scroll-pixel-helper"></div>
<button class="btn rounded-pill" id="pst-back-to-top" type="button">
<i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>
<input class="sidebar-toggle" id="__primary" name="__primary" type="checkbox"/>
<label class="overlay overlay-primary" for="__primary"></label>
<input class="sidebar-toggle" id="__secondary" name="__secondary" type="checkbox"/>
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form action="search.html" class="bd-search d-flex align-items-center" method="get">
<i class="fa-solid fa-magnifying-glass"></i>
<input aria-label="Search this book..." autocapitalize="off" autocomplete="off" autocorrect="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." spellcheck="false" type="search"/>
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
</div>
<header>
<div class="bd-header navbar navbar-expand-lg bd-navbar">
</div>
</header>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
</div>
<div class="sidebar-primary-items__start sidebar-primary__section">
<div class="sidebar-primary-item">
<a class="navbar-brand logo" href="Introduction.html">
<img alt="CQN Winter School 2024 - Exploring and Designing Quantum Networks via Digital Twin Simulations - Home" class="logo__image only-light" src="_static/3protocols.png"/>
<script>document.write(`<img src="_static/3protocols.png" class="logo__image only-dark" alt="CQN Winter School 2024 - Exploring and Designing Quantum Networks via Digital Twin Simulations - Home"/>`);</script>
</a></div>
<div class="sidebar-primary-item"><nav aria-label="Main" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item navbar-nav active">
<ul class="nav bd-sidenav bd-sidenav__home-link">
<li class="toctree-l1">
<a class="reference internal" href="Introduction.html">
                    CQN Winter School - Exploring and Designing Quantum Networks via Digital Twin Simulations
                </a>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1-1%20QMech_Intro.html">Quantum mechanics and Encoding of Quantum Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="1-2%20QKD_Tutorial.html">Exploring Quantum Networks: Practical Introduction with Examples in QKD</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">QuREBB - Quantum Remote Entanglement Building Block Simulations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="3-1%20QuREBB_intro.html">QuREBB: Quantum Remote Entanglement Building Block Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="3-2%20QuREBB_example.html">Example Notebook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Midpoint Source Protocol</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="2-1%20Midpoint_Source_Tutorial.html">Midpoint Source Protocol for Quantum Links</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">QuTiP Quickstart</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lecture 0 - Introduction to QuTiP</a></li>
</ul>
</div>
</nav></div>
</div>
<div class="sidebar-primary-items__end sidebar-primary__section">
</div>
<div id="rtd-footer-container"></div>
</div>
<main class="bd-main" id="main-content">
<div class="sbt-scroll-pixel-helper"></div>
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
<div class="header-article-items header-article__inner">
<div class="header-article-items__start">
<div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__primary" title="Toggle primary sidebar">
<span class="fa-solid fa-bars"></span>
</label></div>
</div>
<div class="header-article-items__end">
<div class="header-article-item">
<div class="article-header-buttons">
<div class="dropdown dropdown-source-buttons">
<button aria-expanded="false" aria-label="Source repositories" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fab fa-github"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-source-repository-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/pr4jitd/2024.CQNSchool.DigitalTwin" target="_blank" title="Source repository">
<span class="btn__icon-container">
<i class="fab fa-github"></i>
</span>
<span class="btn__text-container">Repository</span>
</a>
</li>
<li><a class="btn btn-sm btn-source-issues-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="https://github.com/pr4jitd/2024.CQNSchool.DigitalTwin/issues/new?title=Issue%20on%20page%20%2F0-1 Intro_QuTiP.html&amp;body=Your%20issue%20content%20here." target="_blank" title="Open an issue">
<span class="btn__icon-container">
<i class="fas fa-lightbulb"></i>
</span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
</ul>
</div>
<div class="dropdown dropdown-download-buttons">
<button aria-expanded="false" aria-label="Download this page" class="btn dropdown-toggle" data-bs-toggle="dropdown" type="button">
<i class="fas fa-download"></i>
</button>
<ul class="dropdown-menu">
<li><a class="btn btn-sm btn-download-source-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" href="_sources/0-1 Intro_QuTiP.md" target="_blank" title="Download source file">
<span class="btn__icon-container">
<i class="fas fa-file"></i>
</span>
<span class="btn__text-container">.md</span>
</a>
</li>
<li>
<button class="btn btn-sm btn-download-pdf-button dropdown-item" data-bs-placement="left" data-bs-toggle="tooltip" onclick="window.print()" title="Print to PDF">
<span class="btn__icon-container">
<i class="fas fa-file-pdf"></i>
</span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
</ul>
</div>
<button class="btn btn-sm btn-fullscreen-button" data-bs-placement="bottom" data-bs-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode">
<span class="btn__icon-container">
<i class="fas fa-expand"></i>
</span>
</button>
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" data-bs-placement="bottom" data-bs-toggle="tooltip" for="__secondary" title="Toggle secondary sidebar">
<span class="fa-solid fa-list"></span>
</label>
</div></div>
</div>
</div>
</div>
<div class="onlyprint" id="jb-print-docs-body">
<h1>Lecture 0 - Introduction to QuTiP</h1>
<!-- Table of contents -->
<div id="print-main-content">
<div id="jb-print-toc">
<div>
<h2> Contents </h2>
</div>
<nav aria-label="Page">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-object-class-qobj">Quantum object class: <code class="docutils literal notranslate"><span class="pre">qobj</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-and-inspecting-quantum-objects">Creating and inspecting quantum objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-qobj-instances-for-calculations">Using <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances for calculations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#states-and-operators">States and operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-vectors">State vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-matrices">Density matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qubit-two-level-system-operators">Qubit (two-level system) operators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic-oscillator-operators">Harmonic oscillator operators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-qobj-instances-we-can-check-some-well-known-commutation-relations">Using <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances we can check some well known commutation relations:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composite-systems">Composite systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unitary-dynamics">Unitary dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-values">Expectation values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dissipative-dynamics">Dissipative dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-information">Installation information</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div id="searchbox"></div>
<article class="bd-article">
<section id="lecture-0-introduction-to-qutip">
<h1>Lecture 0 - Introduction to QuTiP<a class="headerlink" href="#lecture-0-introduction-to-qutip" title="Permalink to this heading">#</a></h1>
<p>Author: J. R. Johansson (robert@riken.jp), https://jrjohansson.github.io/</p>
<p>This lecture series was developed by J.R. Johannson. The original lecture notebooks are available <a class="reference external" href="https://github.com/jrjohansson/qutip-lectures">here</a>.</p>
<p>This is a slightly modified version of the lectures, to work with the current release of QuTiP. You can find these lectures as a part of the <a class="reference external" href="https://github.com/qutip/qutip-tutorials">qutip-tutorials repository</a>. This lecture and other tutorial notebooks are indexed at the <a class="reference external" href="https://qutip.org/tutorials.html">QuTiP Tutorial webpage</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="p">(</span><span class="n">Qobj</span><span class="p">,</span> <span class="n">about</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">coherent</span><span class="p">,</span> <span class="n">coherent_dm</span><span class="p">,</span> <span class="n">create</span><span class="p">,</span> <span class="n">destroy</span><span class="p">,</span>
                   <span class="n">expect</span><span class="p">,</span> <span class="n">fock</span><span class="p">,</span> <span class="n">fock_dm</span><span class="p">,</span> <span class="n">mesolve</span><span class="p">,</span> <span class="n">qeye</span><span class="p">,</span> <span class="n">sigmax</span><span class="p">,</span> <span class="n">sigmay</span><span class="p">,</span>
                   <span class="n">sigmaz</span><span class="p">,</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">thermal_dm</span><span class="p">,</span> <span class="n">anim_matrix_histogram</span><span class="p">,</span>
                   <span class="n">anim_fock_distribution</span><span class="p">)</span>
<span class="c1"># set a parameter to see animations in line</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="n">rc</span><span class="p">(</span><span class="s1">'animation'</span><span class="p">,</span> <span class="n">html</span><span class="o">=</span><span class="s1">'jshtml'</span><span class="p">)</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>QuTiP is a python package for calculations and numerical simulations of quantum systems.</p>
<p>It includes facilities for representing and doing calculations with quantum objects such state vectors (wavefunctions), as bras/kets/density matrices, quantum operators of single and composite systems, and superoperators (useful for defining master equations).</p>
<p>It also includes solvers for a time-evolution of quantum systems, according to: Schrodinger equation, von Neuman equation, master equations, Floquet formalism, Monte-Carlo quantum trajectors, experimental implementations of the stochastic Schrodinger/master equations.</p>
<p>For more information see the project web site at <a class="reference external" href="https://qutip.org">qutip.org</a>, and the
<a class="reference external" href="https://qutip.org/docs/latest/index.html">QuTiP documentation</a>.</p>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">#</a></h3>
<p>You can install QuTiP directly from <code class="docutils literal notranslate"><span class="pre">pip</span></code> by running:</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">qutip</span></code></p>
<p>For further installation details, refer to the <a class="reference external" href="https://github.com/qutip/qutip">GitHub repository</a>.</p>
</section>
</section>
<section id="quantum-object-class-qobj">
<h2>Quantum object class: <code class="docutils literal notranslate"><span class="pre">qobj</span></code><a class="headerlink" href="#quantum-object-class-qobj" title="Permalink to this heading">#</a></h2>
<p>At the heart of the QuTiP package is the <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> class, which is used for representing quantum object such as states and operator.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> class contains all the information required to describe a quantum system, such as its matrix representation, composite structure and dimensionality.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">"images/qobj.png"</span><span class="p">)</span>
</pre></div>
</div>
<section id="creating-and-inspecting-quantum-objects">
<h3>Creating and inspecting quantum objects<a class="headerlink" href="#creating-and-inspecting-quantum-objects" title="Permalink to this heading">#</a></h3>
<p>We can create a new quantum object using the <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> class constructor, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">q</span>
</pre></div>
</div>
<p>Here we passed python list as an argument to the class constructor. The data in this list is used to construct the matrix representation of the quantum objects, and the other properties of the quantum object is by default computed from the same data.</p>
<p>We can inspect the properties of a <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instance using the following class method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the dimension, or composite Hilbert state space structure</span>
<span class="n">q</span><span class="o">.</span><span class="n">dims</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the shape of the matrix data representation</span>
<span class="n">q</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the matrix data itself. in sparse matrix format.</span>
<span class="n">q</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the dense matrix representation</span>
<span class="n">q</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># some additional properties</span>
<span class="n">q</span><span class="o">.</span><span class="n">isherm</span><span class="p">,</span> <span class="n">q</span><span class="o">.</span><span class="n">type</span>
</pre></div>
</div>
</section>
<section id="using-qobj-instances-for-calculations">
<h3>Using <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances for calculations<a class="headerlink" href="#using-qobj-instances-for-calculations" title="Permalink to this heading">#</a></h3>
<p>With <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances we can do arithmetic and apply a number of different operations using class methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sy</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>  <span class="c1"># the sigma-y Pauli operator</span>

<span class="n">sy</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sz</span> <span class="o">=</span> <span class="n">Qobj</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>  <span class="c1"># the sigma-z Pauli operator</span>

<span class="n">sz</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># some arithmetic with quantum objects</span>

<span class="n">H</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">sz</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">sy</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Qubit Hamiltonian = </span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
<span class="n">H</span>
</pre></div>
</div>
<p>Example of modifying quantum objects using the <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The hermitian conjugate</span>
<span class="n">sy</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The trace</span>
<span class="n">H</span><span class="o">.</span><span class="n">tr</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eigen energies</span>
<span class="n">H</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">()</span>
</pre></div>
</div>
<p>For a complete list of methods and properties of the <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> class, see the <a class="reference external" href="https://qutip.org/docs/latest/index.html">QuTiP documentation</a> or try <code class="docutils literal notranslate"><span class="pre">help(Qobj)</span></code> or <code class="docutils literal notranslate"><span class="pre">dir(Qobj)</span></code>.</p>
</section>
</section>
<section id="states-and-operators">
<h2>States and operators<a class="headerlink" href="#states-and-operators" title="Permalink to this heading">#</a></h2>
<p>Normally we do not need to create <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances from stratch, using its constructor and passing its matrix represantation as argument. Instead we can use functions in QuTiP that generates common states and operators for us. Here are some examples of built-in state functions:</p>
<section id="state-vectors">
<h3>State vectors<a class="headerlink" href="#state-vectors" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fundamental basis states (Fock states of oscillator modes)</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># number of states in the Hilbert space</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># the state that will be occupied</span>

<span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># equivalent to fock(N, n)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fock</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># another example</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># a coherent state</span>
<span class="n">coherent</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="density-matrices">
<h3>Density matrices<a class="headerlink" href="#density-matrices" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># a fock state as density matrix</span>
<span class="n">fock_dm</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># 5 = hilbert space size, 2 = state that is occupied</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># coherent state as density matrix</span>
<span class="n">coherent_dm</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># thermal state</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># average number of thermal photons</span>
<span class="n">thermal_dm</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Permalink to this heading">#</a></h3>
<section id="qubit-two-level-system-operators">
<h4>Qubit (two-level system) operators<a class="headerlink" href="#qubit-two-level-system-operators" title="Permalink to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pauli sigma x</span>
<span class="n">sigmax</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pauli sigma y</span>
<span class="n">sigmay</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pauli sigma z</span>
<span class="n">sigmaz</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="harmonic-oscillator-operators">
<h4>Harmonic oscillator operators<a class="headerlink" href="#harmonic-oscillator-operators" title="Permalink to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#  annihilation operator</span>

<span class="n">destroy</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># N = number of fock states included in the Hilbert space</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># creation operator</span>

<span class="n">create</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># equivalent to destroy(5).dag()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># the position operator is easily constructed from the annihilation operator</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span>

<span class="n">x</span>
</pre></div>
</div>
</section>
<section id="using-qobj-instances-we-can-check-some-well-known-commutation-relations">
<h4>Using <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances we can check some well known commutation relations:<a class="headerlink" href="#using-qobj-instances-we-can-check-some-well-known-commutation-relations" title="Permalink to this heading">#</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">commutator</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">op2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">op1</span> <span class="o">*</span> <span class="n">op2</span> <span class="o">-</span> <span class="n">op2</span> <span class="o">*</span> <span class="n">op1</span>
</pre></div>
</div>
<p>$[a, a^1] = 1$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="n">commutator</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span>
</pre></div>
</div>
<p><strong>Ops…</strong> The result is not identity! Why? Because we have truncated the Hilbert space. But that’s OK as long as the highest Fock state isn’t involved in the dynamics in our truncated Hilbert space. If it is, the approximation that the truncation introduces might be a problem.</p>
<p>$[x,p] = i$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">())</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">commutator</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Same issue with the truncated Hilbert space, but otherwise OK.</p>
<p>Let’s try some Pauli spin inequalities</p>
<p>$[\sigma_x, \sigma_y] = 2i \sigma_z$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">commutator</span><span class="p">(</span><span class="n">sigmax</span><span class="p">(),</span> <span class="n">sigmay</span><span class="p">())</span> <span class="o">-</span> <span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">sigmaz</span><span class="p">()</span>
</pre></div>
</div>
<p>$-i \sigma_x \sigma_y \sigma_z = \mathbf{1}$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">sigmax</span><span class="p">()</span> <span class="o">*</span> <span class="n">sigmay</span><span class="p">()</span> <span class="o">*</span> <span class="n">sigmaz</span><span class="p">()</span>
</pre></div>
</div>
<p>$\sigma_x^2 = \sigma_y^2 = \sigma_z^2 = \mathbf{1}$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigmax</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">sigmay</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">sigmaz</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="composite-systems">
<h2>Composite systems<a class="headerlink" href="#composite-systems" title="Permalink to this heading">#</a></h2>
<p>In most cases we are interested in coupled quantum systems, for example coupled qubits, a qubit coupled to a cavity (oscillator mode), etc.</p>
<p>To define states and operators for such systems in QuTiP, we use the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> function to create <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances for the composite system.</p>
<p>For example, consider a system composed of two qubits. If we want to create a Pauli $\sigma_z$ operator that acts on the first qubit and leaves the second qubit unaffected (i.e., the operator $\sigma_z \otimes \mathbf{1}$), we would do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sz1</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sigmaz</span><span class="p">(),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">sz1</span>
</pre></div>
</div>
<p>We can easily verify that this two-qubit operator does indeed have the desired properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">psi1</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  <span class="c1"># excited first qubit</span>
<span class="n">psi2</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">basis</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># excited second qubit</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this should not be true,</span>
<span class="c1"># because sz1 should flip the sign of the excited state of psi1</span>
<span class="n">sz1</span> <span class="o">*</span> <span class="n">psi1</span> <span class="o">==</span> <span class="n">psi1</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this should be true, because sz1 should leave psi2 unaffected</span>
<span class="n">sz1</span> <span class="o">*</span> <span class="n">psi2</span> <span class="o">==</span> <span class="n">psi2</span>
</pre></div>
</div>
<p>Above we used the <code class="docutils literal notranslate"><span class="pre">qeye(N)</span></code> function, which generates the identity operator with <code class="docutils literal notranslate"><span class="pre">N</span></code> quantum states. If we want to do the same thing for the second qubit we can do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sz2</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sigmaz</span><span class="p">())</span>

<span class="n">sz2</span>
</pre></div>
</div>
<p>Note the order of the argument to the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> function, and the correspondingly different matrix representation of the two operators <code class="docutils literal notranslate"><span class="pre">sz1</span></code> and <code class="docutils literal notranslate"><span class="pre">sz2</span></code>.</p>
<p>Using the same method we can create coupling terms of the form $\sigma_x \otimes \sigma_x$:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">(</span><span class="n">sigmax</span><span class="p">(),</span> <span class="n">sigmax</span><span class="p">())</span>
</pre></div>
</div>
<p>Now we are ready to create a <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> representation of a coupled two-qubit Hamiltonian: $H = \epsilon_1 \sigma_z^{(1)} + \epsilon_2 \sigma_z^{(2)} + g \sigma_x^{(1)}\sigma_x^{(2)}$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">epsilon</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="n">sz1</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sigmaz</span><span class="p">(),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sz2</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sigmaz</span><span class="p">())</span>

<span class="n">H</span> <span class="o">=</span> <span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">sz1</span> <span class="o">+</span> <span class="n">epsilon</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sz2</span> <span class="o">+</span> <span class="n">g</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">(</span><span class="n">sigmax</span><span class="p">(),</span> <span class="n">sigmax</span><span class="p">())</span>

<span class="n">H</span>
</pre></div>
</div>
<p>To create composite systems of different types, all we need to do is to change the operators that we pass to the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> function (which can take an arbitrary number of operator for composite systems with many components).</p>
<p>For example, the Jaynes-Cumming Hamiltonian for a qubit-cavity system:</p>
<p>$H = \omega_c a^\dagger a - \frac{1}{2}\omega_a \sigma_z + g (a \sigma_+ + a^\dagger \sigma_-)$</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wc</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># cavity frequency</span>
<span class="n">wa</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># qubit/atom frenqency</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># coupling strength</span>

<span class="c1"># cavity mode operator</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">destroy</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># qubit/atom operators</span>
<span class="n">sz</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">sigmaz</span><span class="p">())</span>  <span class="c1"># sigma-z operator</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">destroy</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># sigma-minus operator</span>

<span class="c1"># the Jaynes-Cumming Hamiltonian</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">wc</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">wa</span> <span class="o">*</span> <span class="n">sz</span> <span class="o">+</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">sm</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">sm</span><span class="p">)</span>

<span class="n">H</span>
</pre></div>
</div>
<p>Note that</p>
<p>$a \sigma_+ = (a \otimes \mathbf{1}) (\mathbf{1} \otimes \sigma_+)$</p>
<p>so the following two are identical:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">destroy</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">create</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

<span class="n">a</span> <span class="o">*</span> <span class="n">sp</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">(</span><span class="n">destroy</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">create</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="unitary-dynamics">
<h2>Unitary dynamics<a class="headerlink" href="#unitary-dynamics" title="Permalink to this heading">#</a></h2>
<p>Unitary evolution of a quantum system in QuTiP can be calculated with the <code class="docutils literal notranslate"><span class="pre">mesolve</span></code> function.</p>
<p><code class="docutils literal notranslate"><span class="pre">mesolve</span></code> is short for Master-eqaution solve (for dissipative dynamics), but if no collapse operators (which describe the dissipation) are given to the solve it falls back on the unitary evolution of the Schrodinger (for initial states in state vector for) or the von Neuman equation (for initial states in density matrix form).</p>
<p>The evolution solvers in QuTiP returns a class of type <code class="docutils literal notranslate"><span class="pre">Odedata</span></code>, which contains the solution to the problem posed to the evolution solver.</p>
<p>For example, considor a qubit with Hamiltonian $H = \sigma_x$ and initial state $\left|1\right&gt;$ (in the sigma-z basis): Its evolution can be calculated as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hamiltonian</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">sigmax</span><span class="p">()</span>

<span class="c1"># initial state</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># list of times for which the solver should store the state vector</span>
<span class="n">tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">mesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">result</span></code> object contains a list of the wavefunctions at the times requested with the <code class="docutils literal notranslate"><span class="pre">tlist</span></code> array.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># the finial state</span>
</pre></div>
</div>
<p>You can visualize the time evolution of the state. <code class="docutils literal notranslate"><span class="pre">anim_matrix_histogram</span></code> visualizes the elements of it. The animation below shows that the state changes periodically and that the coefficient of  $\left|1\right&gt;$ is real and that of $\left|0\right&gt;$ is imaginary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">anim_matrix_histogram</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                 <span class="n">bar_style</span><span class="o">=</span><span class="s1">'abs'</span><span class="p">,</span> <span class="n">color_style</span><span class="o">=</span><span class="s1">'phase'</span><span class="p">)</span>
<span class="c1"># close an auto-generated plot and animation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ani</span>
</pre></div>
</div>
<section id="expectation-values">
<h3>Expectation values<a class="headerlink" href="#expectation-values" title="Permalink to this heading">#</a></h3>
<p>The expectation values of an operator given a state vector or density matrix (or list thereof) can be calculated using the <code class="docutils literal notranslate"><span class="pre">expect</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">sigmaz</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expect</span><span class="p">(</span><span class="n">sigmaz</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">expect</span><span class="p">(</span><span class="n">sigmaz</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">states</span><span class="p">))</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$t$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$\left&lt;\sigma_z\right&gt;$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
</pre></div>
</div>
<p>If we are only interested in expectation values, we could pass a list of operators to the <code class="docutils literal notranslate"><span class="pre">mesolve</span></code> function that we want expectation values for, and have the solver compute then and store the results in the <code class="docutils literal notranslate"><span class="pre">Odedata</span></code> class instance that it returns.</p>
<p>For example, to request that the solver calculates the expectation values for the operators $\sigma_x, \sigma_y, \sigma_z$:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">mesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">psi0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[</span><span class="n">sigmax</span><span class="p">(),</span> <span class="n">sigmay</span><span class="p">(),</span> <span class="n">sigmaz</span><span class="p">()])</span>
</pre></div>
</div>
<p>Now the expectation values are available in <code class="docutils literal notranslate"><span class="pre">result.expect[0]</span></code>, <code class="docutils literal notranslate"><span class="pre">result.expect[1]</span></code>, and <code class="docutils literal notranslate"><span class="pre">result.expect[2]</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$\left&lt;\sigma_z\right&gt;$"</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$\left&lt;\sigma_y\right&gt;$"</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">"$\left&lt;\sigma_x\right&gt;$"</span><span class="p">)</span>

<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$t$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="dissipative-dynamics">
<h2>Dissipative dynamics<a class="headerlink" href="#dissipative-dynamics" title="Permalink to this heading">#</a></h2>
<p>To add dissipation to a problem, all we need to do is to define a list of collapse operators to the call to the <code class="docutils literal notranslate"><span class="pre">mesolve</span></code> solver.</p>
<p>A collapse operator is an operator that describes how the system is interacting with its environment.</p>
<p>For example, consider a quantum harmonic oscillator with Hamiltonian</p>
<p>$H = \hbar\omega a^\dagger a$</p>
<p>and which loses photons to its environment with a relaxation rate $\kappa$. The collapse operator that describes this process is</p>
<p>$\sqrt{\kappa} a$</p>
<p>since $a$ is the photon annihilation operator of the oscillator.</p>
<p>To program this problem in QuTiP:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># oscillator frequency</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># relaxation rate</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">destroy</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># oscillator annihilation operator</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="n">fock_dm</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># initial state, fock state with 5 photons</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span>  <span class="c1"># Hamiltonian</span>

<span class="c1"># A list of collapse operators</span>
<span class="n">c_ops</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tlist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># request that the solver return the expectation value</span>
<span class="c1"># of the photon number state operator a.dag() * a</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">mesolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">rho0</span><span class="p">,</span> <span class="n">tlist</span><span class="p">,</span> <span class="n">c_ops</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span><span class="p">],</span>
                 <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">"store_states"</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tlist</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">expect</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"$t$"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Photon number"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">anim_fock_distribution</span></code> enables you to visualize the probability distribution at each time.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ani</span> <span class="o">=</span> <span class="n">anim_fock_distribution</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="c1"># close an auto-generated plot and animation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ani</span>
</pre></div>
</div>
<section id="installation-information">
<h3>Installation information<a class="headerlink" href="#installation-information" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">about</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</article>
<footer class="prev-next-footer">
<div class="prev-next-area">
<a class="left-prev" href="2-1%20Midpoint_Source_Tutorial.html" title="previous page">
<i class="fa-solid fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Midpoint Source Protocol for Quantum Links</p>
</div>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">
<div class="sidebar-secondary-item">
<div class="page-toc tocsection onthispage">
<i class="fa-solid fa-list"></i> Contents
  </div>
<nav class="bd-toc-nav page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation">Installation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quantum-object-class-qobj">Quantum object class: <code class="docutils literal notranslate"><span class="pre">qobj</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-and-inspecting-quantum-objects">Creating and inspecting quantum objects</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-qobj-instances-for-calculations">Using <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances for calculations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#states-and-operators">States and operators</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-vectors">State vectors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-matrices">Density matrices</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#qubit-two-level-system-operators">Qubit (two-level system) operators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#harmonic-oscillator-operators">Harmonic oscillator operators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-qobj-instances-we-can-check-some-well-known-commutation-relations">Using <code class="docutils literal notranslate"><span class="pre">Qobj</span></code> instances we can check some well known commutation relations:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#composite-systems">Composite systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unitary-dynamics">Unitary dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#expectation-values">Expectation values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dissipative-dynamics">Dissipative dynamics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#installation-information">Installation information</a></li>
</ul>
</li>
</ul>
</nav></div>
</div></div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner container">
<div class="footer-item">
<p class="component-author">
By Dirk Englund, Hyeongrak Choi, Prajit Dhara
</p>
</div>
<div class="footer-item">
<p class="copyright">
    
      © Copyright 2022.
      <br/>
</p>
</div>
<div class="footer-item">
</div>
<div class="footer-item">
</div>
</div>
</footer>
</main>
</div>
</div>
<!-- Scripts loaded after <body> so the DOM is not blocked -->
<script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>
<footer class="bd-footer">
</footer>
<script src="_static/scripts/chattutor.config.js"></script><script src="_static/scripts/chattutor.min.js" type="module"></script></body>
</html>